<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script
            src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>

    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
</head>
<body>
number of players: <span id="players"></span>
<br><br>
drums:
<div class="d-inline" id="q" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; Q &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="w" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; W &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="e" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; E &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="r" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; R &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="t" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; T &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="y" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; Y &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="u" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; U &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="i" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; I &nbsp;&nbsp;&nbsp;</div>
<br><br>
saxophone:
<div class="d-inline" id="a" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; A &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="s" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; S &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="d" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; D &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="f" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; F &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="g" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; G &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="h" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; H &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="j" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; J &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="k" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; K &nbsp;&nbsp;&nbsp;</div>
<br><br>
piano:
<div class="d-inline" id="z" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; Z &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="x" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; X &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="c" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; C &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="v" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; V &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="b" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; B &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="n" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; N &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="m" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; M &nbsp;&nbsp;&nbsp;</div>
<div class="d-inline" id="higher_do" style="border: 2px solid dimgrey">&nbsp;&nbsp;&nbsp; , &nbsp;&nbsp;&nbsp;</div>

<script src="/socket.io/socket.io.js"></script>
<script src="/js/howler.js"></script>
<script>
    var piano_notes = {};
    var sax_notes = {};
    var drums = {};
    var myColor;

    preloadPianoHowler();
    preloadSaxHowler();
    preloadDrumsHowler();

    var socket = io();

    socket.on('connect', function() {
        socket.on('connectionsChanged', function(data) {
            $("#players").html(data.connections);
        });

        socket.on('setColor', function (data) {
            myColor = data.color;
        })
    });

    $(document).keydown(function(keyPressed) {
        switch (keyPressed.keyCode) {
            //piano
            case 90:
                activatePianoHowl('lower_do');
                colorDiv('z', myColor);
                socket.emit('pianoKeyPressed', {key: 'lower_do', divid: 'z'});
                break;
            case 88:
                activatePianoHowl('re');
                colorDiv('x', myColor);
                socket.emit('pianoKeyPressed', {key: 're', divid: 'x'});
                break;
            case 67:
                activatePianoHowl('mi');
                colorDiv('c', myColor);
                socket.emit('pianoKeyPressed', {key: 'mi', divid: 'c'});
                break;
            case 86:
                activatePianoHowl('fa');
                colorDiv('v', myColor);
                socket.emit('pianoKeyPressed', {key: 'fa', divid: 'v'});
                break;
            case 66:
                activatePianoHowl('sol');
                colorDiv('b', myColor);
                socket.emit('pianoKeyPressed', {key: 'sol', divid: 'b'});
                break;
            case 78:
                activatePianoHowl('la');
                colorDiv('n', myColor);
                socket.emit('pianoKeyPressed', {key: 'la', divid: 'n'});
                break;
            case 77:
                activatePianoHowl('si');
                colorDiv('m', myColor);
                socket.emit('pianoKeyPressed', {key: 'si', divid: 'm'});
                break;
            case 188:
                activatePianoHowl('higher_do');
                colorDiv('higher_do', myColor);
                socket.emit('pianoKeyPressed', {key: 'higher_do', divid: 'higher_do'});
                break;

            //sax
            case 65:
                activateSaxHowl('lower_do');
                colorDiv('a', myColor);
                socket.emit('saxKeyPressed', {key: 'lower_do', divid: 'a'});
                break;
            case 83:
                activateSaxHowl('re');
                colorDiv('s', myColor);
                socket.emit('saxKeyPressed', {key: 're', divid: 's'});
                break;
            case 68:
                activateSaxHowl('mi');
                colorDiv('d', myColor);
                socket.emit('saxKeyPressed', {key: 'mi', divid: 'd'});
                break;
            case 70:
                activateSaxHowl('fa');
                colorDiv('f', myColor);
                socket.emit('saxKeyPressed', {key: 'fa', divid: 'f'});
                break;
            case 71:
                activateSaxHowl('sol');
                colorDiv('g', myColor);
                socket.emit('saxKeyPressed', {key: 'sol', divid: 'g'});
                break;
            case 72:
                activateSaxHowl('la');
                colorDiv('h', myColor);
                socket.emit('saxKeyPressed', {key: 'la', divid: 'h'});
                break;
            case 74:
                activateSaxHowl('si');
                colorDiv('j', myColor);
                socket.emit('saxKeyPressed', {key: 'si', divid: 'j'});
                break;
            case 75:
                activateSaxHowl('higher_do');
                colorDiv('k', myColor);
                socket.emit('saxKeyPressed', {key: 'higher_do', divid: 'k'});
                break;


            //drums
            case 81:
                activateDrumsHowl('bass');
                colorDiv('q', myColor);
                socket.emit('drumKeyPressed', {drum: 'bass', divid: 'q'});
                break;
            case 87:
                activateDrumsHowl('snare');
                colorDiv('w', myColor);
                socket.emit('drumKeyPressed', {drum: 'snare', divid: 'w'});
                break;
            case 69:
                activateDrumsHowl('hat_closed');
                colorDiv('e', myColor);
                socket.emit('drumKeyPressed', {drum: 'hat_closed', divid: 'e'});
                break;
            case 82:
                activateDrumsHowl('hat_open');
                colorDiv('r', myColor);
                socket.emit('drumKeyPressed', {drum: 'hat_open', divid: 'r'});
                break;
            case 84:
                activateDrumsHowl('crash');
                colorDiv('t', myColor);
                socket.emit('drumKeyPressed', {drum: 'crash', divid: 't'});
                break;
            case 89:
                activateDrumsHowl('tom3');
                colorDiv('y', myColor);
                socket.emit('drumKeyPressed', {drum: 'tom3', divid: 'y'});
                break;
            case 85:
                activateDrumsHowl('tom2');
                colorDiv('u', myColor);
                socket.emit('drumKeyPressed', {drum: 'tom2', divid: 'u'});
                break;
            case 73:
                activateDrumsHowl('tom1');
                colorDiv('i', myColor);
                socket.emit('drumKeyPressed', {drum: 'tom1', divid: 'i'});
                break;
            default:
                //nothing
        }
    });

    socket.on('pressPianoKey', function (data) {
        activatePianoHowl(data.key);
        colorDiv(data.divid, data.color);
    });

    socket.on('pressSaxKey', function (data) {
        activateSaxHowl(data.key);
        colorDiv(data.divid, data.color);
    });

    socket.on('pressDrumKey', function (data) {
        activateDrumsHowl(data.drum);
        colorDiv(data.divid, data.color);
    });

    function preloadPianoHowler() {
        var lower_do = new Howl({
            src: [`piano/lower_do.wav`],
            preload: true
        });
        var re = new Howl({
            src: [`piano/re.wav`],
            preload: true
        });
        var mi = new Howl({
            src: [`piano/mi.wav`],
            preload: true
        });
        var fa = new Howl({
            src: [`piano/fa.wav`],
            preload: true
        });
        var sol = new Howl({
            src: [`piano/sol.wav`],
            preload: true
        });
        var la = new Howl({
            src: [`piano/la.wav`],
            preload: true
        });
        var si = new Howl({
            src: [`piano/si.mp3`],
            volume: 0.2,
            preload: true
        });
        var higher_do = new Howl({
            src: [`piano/higher_do.wav`],
            preload: true
        });

        piano_notes = {
            lower_do,
            re,
            mi,
            fa,
            sol,
            la,
            si,
            higher_do
        };
    }

    function preloadSaxHowler() {
        var lower_do = new Howl({
            src: [`saxophone/lower_do.wav`],
            preload: true
        });
        var re = new Howl({
            src: [`saxophone/re.wav`],
            preload: true
        });
        var mi = new Howl({
            src: [`saxophone/mi.wav`],
            preload: true
        });
        var fa = new Howl({
            src: [`saxophone/fa.wav`],
            preload: true
        });
        var sol = new Howl({
            src: [`saxophone/sol.wav`],
            preload: true
        });
        var la = new Howl({
            src: [`saxophone/la.wav`],
            preload: true
        });
        var si = new Howl({
            src: [`saxophone/si.wav`],
            preload: true
        });
        var higher_do = new Howl({
            src: [`saxophone/higher_do.wav`],
            preload: true
        });

        sax_notes = {
            lower_do,
            re,
            mi,
            fa,
            sol,
            la,
            si,
            higher_do
        };
    }

    function preloadDrumsHowler() {
        var bass = new Howl({
            src: [`drums/bass.wav`],
            preload: true
        });
        var snare = new Howl({
            src: [`drums/snare.wav`],
            preload: true
        });
        var hat_closed = new Howl({
            src: [`drums/hat-closed.wav`],
            preload: true
        });
        var hat_open = new Howl({
            src: [`drums/hat-open.wav`],
            preload: true
        });
        var crash = new Howl({
            src: [`drums/crash.wav`],
            preload: true
        });
        var tom1 = new Howl({
            src: [`drums/tom1.wav`],
            preload: true
        });
        var tom2 = new Howl({
            src: [`drums/tom2.wav`],
            preload: true
        });
        var tom3 = new Howl({
            src: [`drums/tom3.wav`],
            preload: true
        });

        drums = {
            bass,
            snare,
            hat_closed,
            hat_open,
            crash,
            tom1,
            tom2,
            tom3
        };
    }

    function activatePianoHowl(key) {
        piano_notes[key].play();
    }
    
    function activateSaxHowl(key) {
        sax_notes[key].play();
    }

    function activateDrumsHowl(drum) {
        drums[drum].play();
    }

    function colorDiv(divId, color) {
        $(`#${divId}`).css('background-color', `#${color}`);

        setTimeout(function () {
            $(`#${divId}`).css('background-color', 'white');
        }, 100);
    }
</script>
</body>
</html>